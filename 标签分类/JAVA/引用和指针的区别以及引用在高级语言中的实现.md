# 引用和指针的区别与引用在高级语言中的实现

今天在看别人博客时,偶然看见一句评论:引用就是指针这句话就是错误的,引用是引用,指针是指针。  
思考再三,觉得他说的是对的,但是却不知为而是对的,因为一直以来都把引用当做指针了。后查阅文章后整理了两者的区别,见下文。

### 指针和引用的使用  

对于C++程序员来说指针和引用都是经常会接触到的东西,而对于其他语言的程序员,可能大部分只能接触到引用。  
在C++使用指针和引用如下:

``` c
int i = 5;
int &ri = i;    //ri作为i的引用
int *p = &i;    //指针p指向i的地址
```

而在其他语言中就只能使用引用了,而无法使用指针，如下:

``` javascript
//java中的引用
Person person = new Person();       //一个Person类型对象的引用

//JavaScript中的引用
let a = new Object();               //一个对象的引用
```

### C++中指针和引用的区别  

对于C++中指针和引用的区别,先将最根本的区别:  
两者最本质的区别在于C++中指针占用内存,而引用不占用内存,指针是一个变量,只不过这个变量存储的是一个地址,指向内存的一个存储单元;而引用更原来的变量实质上是同一个东西,只不过是原变量的一个别名而已。其他所有的区别都是基于此产生的。 

对于该区别,见如下代码:

``` c
int a = 1;
int &c = a;     //定义一个c引用a
int *p = a;    //定义一个指针p指向a
```

这段代码在编译器中的解释如下:
 * 1:int a = 1; 向内存中申请一个int型变量,并向其中添加值为1,此时,”a“代表的是一个内存地址,在编译器将代码生成目标文件时,会用这个地址替代所有的a,因此目标文件中就再也没有变量名a了,所以变量名a不会占用内存空间,
 * 2:int &c = a; 定义一个c引用a,此时,c和a,其实是相同的东西,区别只在于别名不同,同时,”c“代表着和a同样的内存地址,在编译器将代码生成目标文件时,会用这个地址替换所有的a
 * 3:int *p = a; 定义一个指针p指向a, 此时, 该代码会向内存中申请一个地址空间用于保存内存地址(32位机中是4个字节,64位机中是8个字节), 而该内存地址中保存的值是a的地址, 在编译器将代码生成目标文件时,p将会被替换成指针的地址,而该地址中保存的值是a的地址,

所以,以此区别为根本产生的其他区别如下也很容易解释了:
 * 引用不可以为空,当被创建的时候,必须初始化,而指针可以是空值,可以在任何情况下被初始化
 * 可以用const指针,但是没有const引用
 * 指针可以有多级,但是引用只能是一级,
 * 指针的值可以为空,但是引用的值不能为NULL,并且引用在定义的时候必须初始化
 * "sizeof引用"得到的是所指向的变量(对象)的大小,而"sizeof指针"得到的是指针本身的大小

### 引用在高级语言中的实现

在C++中,我们知道引用本身是不占空间的,但是在其他高级语言中却又不同(如JavaScript,java,这里高级语言仅指这两种,因为其他的语言了解的不深,下文中的高级语言也仅指JavaScript,java。不包括其他语言),在其他高级语言中,引用又是和指针相差仿佛,引用本身占空间。  
我们知道,内存的存储区域分为栈,堆,常量存储区三部分。在其中,常量存储区存放常量,栈内存存放基本数据类型,堆内存存放引用数据类型。关于堆内存和栈内存的区别,可以看我的这篇博客:
[程序运行中堆内存和栈内存的区别]("https://github.com/StrongDwarf/learning-notes/blob/master/时间分类/2018/11月/程序运行中堆内存与栈内存的区别.md")  
对于其他高级语言来说,当声明一个变量时,将声明的变量字面量存放在该变量所在的运行栈常量池中,当对变量赋值时,如果赋值为基本数据类型,则将赋的值存放在栈内存中,如果赋值为引用类型,则将该类型存放在堆内存中。 


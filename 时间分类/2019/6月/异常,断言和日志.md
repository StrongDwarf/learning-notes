# 异常,断言和日志

若程序在运行时间如果发生错误,必需做到以下几点:

* 向用户报告错误
* 保存所有的工作结果
* 允许用户以妥善的形式退出程序

## 1 处理错误

### 1.1 异常分类

所有的异常都是由Throwable继承而来,但在下一层立即分解为两个分支:Error和Exception

Error类层次结构描述了java运行时系统的内部错误和资源耗尽错误。引用程序不应该抛出这种类型的对象。如果出现了这样的内部错误,除了通告给用户,并尽力使程序安全地终止之外,再也无能为力了。

Exception又分为两个分支:RuntimeException和IOException

派生于RuntimeException的异常包含下面几种情况:

* 错误的类型转换
* 数组访问越界
* 访问null指针

不是派生于RuntimeException的异常包括

* 试图在文件尾部后面读取数据
* 试图打开一个不存在的文件
* 试图根据给定的字符串查找Class对象,

如果出现RuntimeException异常,那么就一定是你的问题。

应该通过检测数组下标是否越界来避免ArrayIndexOutOfBoundsException异常;应该通过在使用变量之前检测是否为null来杜绝NullPointerException异常的发生。

java语言规范将派生于Error类或RunimeException类的所有异常称为非受差异常,其他所有的异常称为受差异常。

### 1.2 声明受查异常

在自己编写方法时,不必将所有可能抛出的异常都进行声明。至于什么时候需要在方法中用throws子句声明异常，什么异常必须使用throws子句声明，需要记住在下面4种情况应该抛出异常:

* 1) 调用一个抛出受查异常的方法,例如: FileInputStream构造器
* 2) 程序运行过程中发现错误,并且利用throw语句抛出一个受查异常
* 3) 程序出现错误, 例如, a[-1]=0会抛出一个ArrayIndexOutOfBoundsException这样的非受查异常
* 4) java虚拟机和运行时库出现的内部错误


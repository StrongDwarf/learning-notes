# 数据库基础复习

## SQL的功能

### 数据查询

* 选择符合条件的记录: select * from table where 条件语句
* 插入一条记录:insert into table(字段1,字段2,...) values(值1,值2,...)

### 数据操纵

* 更新:update table set 字段名=字段值 where 条件表达式
* 删除:delete from table where 字段名=字段值

### 数据定义

* 建立:create table tablename(字段1,字段2,...)
* 删除：drop table tablename

### 数据控制

* 为用户授予系统权限:grant
* 收回系统权限:revoke

值得注意的是delete操作后,被删除的数据占用的存储空间还在，还可以恢复。而用truncate操作删除数据后,被删除的数据会立即释放所占有的存储空间,被删除数据是不能被恢复的

## 内连接与外连接

内连接:也称为自然连接,只有两个表相匹配的行才能在结果集中出现,返回的结果集是两个表中所有匹配的数据,而舍弃不匹配的数据。
外连接:外连接不仅包含符合条件的行,而且还包括左表(左外连接时),右表(右外连接),或两个边接表(全外连接)中的所有数据行。也就是说,只限制其中一个表的行，而不限制另一个表的行。

## 事务

事务是一个操作序列。这些操作要么都做，要么都不做,是一个不可分割的工作单元,事务通常一 begin transaction开始,以commit或rollback操作结束，commit即提交,提交事务中所有的操作,事务正常结束。rollback即回滚,撤销已做的所有操作,回滚到事务开始时的状态

## 存储过程与函数

存储过程是用户定义的一系列SQL语句的集合,涉及特定表或其他对象的任务,用户可以调用存储过程,而函数通常是数据库已定义的方法,它接收参数并返回某种类型的值并且不涉及特定用户表

## 数据库范式

### 第一范式

所谓第一范式是指在关系模型中.对域添加的一个规范要求,所有的域都应该是原子性的，即数据库表的每一列都是不可分割的原子数据项,而不能是集合,数组,记录等非原子数据项

### 第二范式

第二范式要求数据库表中的每一个实例或记录必须可以被唯一的区分。

### 第三范式

第三范式要求一个关系中不包含已在其他关系已包含的非主关键字信息。

例如:存在一个部门信息表,其中,每个部门有部门编号,部门名称,部门简介等信息。那么在员工信息表中列出部门编号后就不能再将部门名称,部门简介等于部门有关的信息再加入员工信息表中。

## 触发器

触发器是一种特殊类型的存储过程,由事件触发,而不是程序调用或手工启动,当特定的操作被执行的时候,会触发触发器自动执行触发器定义的SQL语句。使用触发器可以保证数据的有效性和完整性,完成比约束更复杂的数据约束

## 游标

游标允许应用程序对查询语句select返回的行结果集中每行进行相同或不同的操作,而不是一次对整个结果集进行同一种操作

## 数据库日志

日志文件记录所有对数据库数据的修改,主要是保护数据库以防止故障,以及恢复数据时使用。其特点如下:

* 每个数据库至少包含两个日志文件组。每个日志文件组至少包含两个日志文件成员.
* 日志文件组以循环方式进行写操作
* 每个日志文件成员对应一个物理文件

通过日志文件记录数据库事务可以最大限度保证数据的一致性与安全性,但一旦数据库中的日志满了,就只能执行查询等读操作,不能执行更改操作,备份等操作，原因是任何写操作都有记录日志,也就是说,基本处于不能使用的状态

## union与union all

union在进行表求并集合后会去掉重复的元素,而union all不会去掉重复的元素。

所以union比union all快很多

## 视图

视图是从数据库中的基本表中选举出来的数据组成的逻辑窗口,不同于基本表,它是一个虚表，在数据库中,存放的只是视图的定义而已,不存放视图包含的数据项,这些项目仍然存放在原来的基本表结构中,只有在查询的时候,才会去执行视图的定义来查下所需的数据

## 数据库分类

## 死锁

### 产生原因

* 系统资源不足
* 进程运行推进的顺序不合适
* 资源分配不当
* 占用资源的程序崩溃

### 产生条件

* 互斥条件:一个资源每次只能被一个进程使用
* 请求和保持
* 不可剥夺
* 循环等待

## 数据库优化法

* 优秀的管理工具
* 数据分区
* 索引
* 缓存机制
* 加大虚存
* 分批处理
* 使用临时表和中间表
* 优化查询语句
* 使用视图
* 使用存储过程
* 用排序来取代非顺序存储
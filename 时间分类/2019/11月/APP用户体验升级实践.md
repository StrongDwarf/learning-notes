# APP用户体验升级实践

###### @author zhuzecong
###### @createTime 2019/11/16
###### @notes 这篇文章可能会比较长,哈哈,因为给一个APP的用户体验升级涉及到的东西太多了
###### @notes 相比成为顶级程序员,成为顶级产品经理更吸引我

自从来到项目组后,经常就听到产品经理说"又被业务叼了","业务说我们的APP太丑","业务说我们的APP不好用"。每一次从产品经理口中听到这样的话,我心里都很不是滋味,一方面,作为项目组中的一员,叼产品经理不就是叼我们项目组么,不就是叼我么。另一方面,作为一个程序员,产品就像儿子,儿子好看优秀才是每个父亲最希望看到的事情,有人说儿子烂,当父亲的感觉可想而知。

最近一月,在项目组开发任务终于缓了一些后,终于有时间去进行优化了。

以下是一些优化过程中的实践,有兴趣的可以了解下。

## 目录

* [1,让APP好看起来-样式优化](#1，让APP好看起来-APP样式优化)
  * [1.1,选择一个主题色](#1.1,选择一个主题色)
  * [1.2,简约,即是美](#1.2,简约,即是美)
  * [1.3,将注意力还给用户](#1.3,将注意力还给用户)
  * [1.4,背景色,元素色,线条,阴影之间的故事](#1.4,背景色,元素色,线条,阴影之间的故事)
* [2,让APP好用起来-交互优化](#2,让APP好用起来-交互优化)
  * [2.1,交互只能做减法](#2.1,交互只能做减法)
  * [2.2,面向产品经理的错误提示设计]
    * [2.2.1,页面级错误提示设计](#2.2.1,页面级错误提示设计)
    * [2.2.2,接口级错误提示设计](#2.2.2,接口级错误提示设计)
  * [2.3,后端编程让异常无处可跑的小技巧](#2.3,后端编程让异常无处可跑的小技巧)
    * [2.3.1,try...catch...统筹全局](#2.3.1,try...catch...统筹全局)
    * [2.3.2,终点之外只有异常](#2.3.2,终点之外只有异常)
* [3,让APP快起来-性能优化](#3,让APP快起来-性能优化)
  * [3.1,"看起来很快"比"实际很快"更重要](#3.1,"看起来很快"比"实际很快"更重要)
  * [3.2,延迟渲染](#3.2,延迟渲染)
  * [3.3,请求缓存](#3.3,请求缓存)
  * [3.4,sql优化](#3.4,sql优化)
    * [3.4.1,使用索引](#3.4.1,使用索引)
    * [3.4.2,避免在where字句中使用or来连接条件](#3.4.2,避免在where字句中使用or来连接条件)
    * [3.4.3,能用between就不要用in](#3.4.3,能用between就不要用in)
    * [3.4.4,避免在where子句中对字段进行表达式操作](#3.4.4,避免在where子句中对字段进行表达式操作)
    * [3.4.5,少用like%xxx%](#3.4.5,少用like%xxx%)
  * [3.5,微服务合并](#3.5,微服务合并)
* [4,让APP自我迭代](#4,让APP自我迭代)
  * [4.1,监控url请求数量](#4.1,监控url请求数量)
  * [4.2,监控控件和页面使用率](#4.2,监控控件和页面使用率)
  * [4.3,向用户接收反馈](#4.3,向用户接收反馈)
* [5,总结](#5,总结)

## 1，让APP好看起来-样式优化

关于样式,在优化APP之前,和需求聊了一下,需求表示业务对我们APP样式的评价是:"就是觉得丑,具体哪里丑我也说不上来"。

"美"与"丑","好看"与"不好看"。往往就是这样,我就是觉得你丑,但是你要问我觉得你哪里丑,那我还真说不上来。

怎样的是美?怎样的是丑?我认为借用python之禅里的几句话可以很好的解释。

* 优美胜于丑陋（美的APP以"优美"为目标）
* 明了胜于晦涩（优美的APP应是功能明了的）
* 简洁胜于复杂（优美的APP应是简洁的）
* 复杂胜于凌乱（如果复杂不可避免，那功能间也不能有难懂的关系，要保持功能分类合理）
* 扁平胜于嵌套（优美的APP应当是扁平的）
* 间隔胜于紧凑（优美的APP元素与元素之间应该有适当的间隔）
* 可读性很重要（优美的APP是可读的）

### 1.1,选择一个主题色

移动互联网发展到今天,APP之间的竞争也早已从功能层次的厮杀升级到了"特色"的厮杀,APP的主题色即是APP样式层面的"特色",APP的主题色应与APP的业务场景形成清晰的对应关系,如下是一些常用APP的主题色:

淘宝主题色:给人的感觉如阳光微撒,活力无限,像是初夏走在阳光下的购物街上(淘宝业务:购物)。

<img alt="主题色-淘宝图片" src="https://github.com/StrongDwarf/learning-notes/blob/master/public/img/APP用户体验升级/主题色-淘宝.jpg?raw=true" width="400"/>

支付宝主题色:沉着冷静，成熟稳重。(支付宝业务:支付,储蓄,理财)

<img alt="主题色-支付宝图片" src="https://github.com/StrongDwarf/learning-notes/blob/master/public/img/APP用户体验升级/主题色-支付宝.jpg?raw=true" width="400"/>

QQ主题色:白色作为底调，淡蓝色作为主题色，给人的印象是还是学生时候的纯白年代，以及那些清淡，青涩的感情。(QQ主要客群:学生)

<img alt="主题色-QQ图片" src="https://github.com/StrongDwarf/learning-notes/blob/master/public/img/APP用户体验升级/主题色-QQ.png?raw=true" width="400"/>

我的APP的主题色:继(chao)承(xi)自支付宝的沉着冷静,成熟稳重。但更加鲜活,代表着我的APP更有活力(我喜欢有活力的感觉)。(我的APP业务:支付,商户收款)

<img alt="主题色-我的APP图片" src="https://github.com/StrongDwarf/learning-notes/blob/master/public/img/APP用户体验升级/主题色-我的APP.jpg?raw=true" width="400"/>

### 1.2,简约,即是美

什么是简约?在《互联网思维》中有个很好的解释:外在部分,外观要足够简洁;内在部分,操作流程要足够简化。

样式层的简约其实可以简单的理解为页面中的元素尽可能的"少",这种少是视觉上的少(可能实际中却增加了)。

要理解"简约",其实还可以参考代码层面的"优美的代码","优美的代码:功能一目了然,逻辑一目了然"

以前实习时候,实习导师对我的代码要求是:"如果你写的代码我5秒内没看懂,那就需要重构"。我认为这句话放在一款产品的样式层面也是适用的,如果一款产品,一个页面,5秒钟我没对页面中的功能形成一个强烈印象的话,那么这个页面的样式就需要"重构"。

那么怎样的页面是用户5秒类无法形成强烈印象的页面?这个问题其实也可以先讨论代码层面的问题"什么样的代码是5秒内不能让人看懂的代码？"。

对于这个问题我想大家很快脑海中就会想起那些职业生涯中难以忘记的"烂"代码和优雅的好代码。

对于那些5秒内让人看不懂的代码,我总结了以下,大抵是符合如下1或多条的代码:

* 1:代码行数多
* 2:命名烂而且代码没注释
* 3:代码注释太多太详细
* 4:代码组织不合理

而那些让人5秒内就能看懂的代码无非是:代码行数少,命名好,注释充分但不累赘,组织合理。

将上面的情况翻译到样式层面就是:

用户5秒类无法形成强烈印象的页面拥有的特征是:

* 1:页面中功能太多
* 2:功能命名烂而且没注释
* 3:页面功能注释太多,导致用户注意力不在功能本身,而在功能注释上
* 4:页面功能组织不合理

这里的"注释"在页面层次中指的是ICON(图标),IMG(图片),specialStyle(特殊样式),如下图片中用红圈标注的就是功能的"注释":

<img alt="发现精彩-首页-图标-注释图片" src="https://github.com/StrongDwarf/learning-notes/blob/master/public/img/APP用户体验升级/发现精彩-首页-图标-注释.png?raw=true" width="400"/>

<img alt="发现精彩-首页-今日美食-注释图片" src="https://github.com/StrongDwarf/learning-notes/blob/master/public/img/APP用户体验升级/发现精彩-首页-今日美食-注释.png?raw=true" width="400"/>

###### 事实上,对"功能来说",所有的文字,图片,样式都是功能的注释。

#### 1.2.1 页面中功能太多

"页面中功能太多":在用户感知中,页面中有多少功能?请先看一段伪代码示例。

现在有如下两段伪代码,分别表示页面A,和页面B。其中,对页面A而言,页面A中的100个功能是直接写在页面A中的,而页面B中的200个功能,分了4个代码段分别写在页面中。

在这个伪代码例子中回答上面的问题,可以很肯定的回答道:在用户感知中,页面A中有100个功能,而页面B中只有4个功能(页面B中的做法不正是我们写代码常用的函数抽取法么ლ(′◉❥◉｀ლ))。

``` java
// 代码段1: 页面A
{
    // 100 functions
}

// 代码段2: 页面B
{
    // segment 1
    {
        // 50 functions
    }

    // segment 2
    {
        // 50 functions
    }

    // segment 3
    {
        // 50 functions
    }

    // segment 4
    {
        // 50 functions
    }
}
```

###### 实例

可以看一个实例:



下面两张图,是首页样式优化前后的对比图。

<img alt="主题色-我的APP图片" src="https://github.com/StrongDwarf/learning-notes/blob/master/public/img/APP用户体验升级/首页-优化前.png?raw=true" width="400"/>

<img alt="主题色-我的APP图片" src="https://github.com/StrongDwarf/learning-notes/blob/master/public/img/APP用户体验升级/首页-优化后.png?raw=true" width="400"/>

优化后的首页虽然新增了两个元素(如下),但却将原来"首页中有很多元素"的视觉效果变成了首页中只有"两个元素"的视觉效果,使得用户对首页拥有的功能更清晰了。

<img alt="主题色-我的APP图片" src="https://github.com/StrongDwarf/learning-notes/blob/master/public/img/APP用户体验升级/首页-优化后1.png?raw=true" width="400"/>



《新定位》一书中列出了消费者的五大思考模式特性:消费者只能接收有限的信息,消费者喜欢简单,消费者缺乏安全感,消费者对品牌的印象不会轻易改变,消费者的想法容易失去焦点。